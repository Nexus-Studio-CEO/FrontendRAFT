<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FrontendRAFT - Reactive API for Frontend Transformation</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['Fira Code', 'monospace'],
                    },
                    colors: {
                        primary: { DEFAULT: '#6366f1', hover: '#4f46e5' },
                        secondary: { DEFAULT: '#8b5cf6', hover: '#7c3aed' },
                        success: '#10b981',
                        warning: '#f59e0b',
                        error: '#ef4444',
                        surface: '#1e293b',
                        background: '#0f172a',
                        text: '#f1f5f9'
                    }
                }
            }
        }
    </script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }
        .monaco-line-number { color: #475569; padding-right: 16px; text-align: right; user-select: none; }
        .code-keyword { color: #c084fc; }
        .code-function { color: #60a5fa; }
        .code-string { color: #34d399; }
        .log-entry { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }
    </style>
</head>
<body class="bg-background text-text antialiased min-h-screen flex flex-col overflow-hidden">

    <div class="fixed top-0 left-0 w-full z-50 bg-black text-white p-2 text-xs flex justify-between items-center border-b border-gray-700">
        <div class="font-bold flex items-center gap-2">
            <span>âš¡ FrontendRAFT</span>
            <span class="bg-primary px-2 py-0.5 rounded-full text-[10px]">v0.1.0</span>
            <span class="text-gray-500">Inspired by CSOP</span>
        </div>
        <div class="flex gap-4">
            <span class="text-slate-400">APIs: <span id="api-count" class="text-white">0</span></span>
            <span class="text-slate-400">Deployed: <span id="deployed-count" class="text-success">0</span></span>
        </div>
    </div>

    <div id="app-container" class="flex-1 flex pt-8 h-screen relative overflow-hidden">
        
        <aside id="sidebar" class="w-64 bg-surface border-r border-slate-700 flex flex-col fixed md:relative z-40 h-full transition-transform transform -translate-x-full md:translate-x-0 pt-4 overflow-y-auto" style="-webkit-overflow-scrolling: touch;">
            <div class="px-6 mb-8 flex items-center gap-2">
                <i class="ph-fill ph-lightning text-primary text-2xl"></i>
                <h1 class="font-bold text-lg tracking-tight">FrontendRAFT</h1>
            </div>

            <nav class="flex-1 px-4 space-y-1 overflow-y-auto">
                <div class="text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2 px-2">Platform</div>
                <a href="#" onclick="setView('builder'); return false;" class="flex items-center gap-3 px-3 py-2 bg-slate-700/50 text-primary rounded-md text-sm font-medium border-l-2 border-primary">
                    <i class="ph ph-squares-four text-lg"></i>
                    My APIs
                </a>
                <a href="#" onclick="setView('logs'); return false;" class="flex items-center gap-3 px-3 py-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-md text-sm font-medium transition-colors">
                    <i class="ph ph-terminal text-lg"></i>
                    Debug Logs
                </a>
                <a href="#" onclick="showDocs(); return false;" class="flex items-center gap-3 px-3 py-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-md text-sm font-medium transition-colors">
                    <i class="ph ph-book text-lg"></i>
                    Docs
                </a>

                <div class="mt-8 text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2 px-2 flex justify-between items-center">
                    <span>Projects</span>
                    <button onclick="createNewAPI()" class="text-primary hover:text-white transition"><i class="ph-bold ph-plus"></i></button>
                </div>
                
                <div id="projects-list"></div>
            </nav>

            <div class="p-4 border-t border-slate-700">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 rounded-full bg-gradient-to-tr from-primary to-secondary flex items-center justify-center font-bold text-xs">DA</div>
                    <div class="flex-1 min-w-0">
                        <p class="text-sm font-medium truncate">Dev User</p>
                        <p class="text-xs text-slate-500 truncate">Free Plan</p>
                    </div>
                </div>
            </div>
        </aside>

        <div id="sidebar-overlay" onclick="toggleSidebar()" class="fixed inset-0 bg-black/50 z-30 hidden md:hidden"></div>

        <main class="flex-1 flex flex-col min-w-0 h-full overflow-hidden relative">
            
            <header class="h-14 border-b border-slate-700 bg-background/95 backdrop-blur flex items-center justify-between px-4 sticky top-0 z-20">
                <div class="flex items-center gap-4">
                    <button onclick="toggleSidebar()" class="md:hidden text-slate-400 hover:text-white">
                        <i class="ph text-2xl ph-list"></i>
                    </button>
                    <nav class="flex space-x-1 bg-surface p-1 rounded-lg border border-slate-700">
                        <button onclick="setView('builder')" id="tab-builder" class="px-3 py-1 text-xs font-medium rounded-md bg-slate-600 text-white shadow-sm transition-all">Builder</button>
                        <button onclick="setView('deploy')" id="tab-deploy" class="px-3 py-1 text-xs font-medium rounded-md text-slate-400 hover:text-white transition-all">Deploy</button>
                        <button onclick="setView('logs')" id="tab-logs" class="px-3 py-1 text-xs font-medium rounded-md text-slate-400 hover:text-white transition-all">Logs</button>
                    </nav>
                </div>
                
                <div class="flex items-center gap-3">
                    <div class="hidden sm:flex items-center gap-2 text-xs text-slate-500 bg-surface px-2 py-1 rounded border border-slate-700">
                        <span class="w-2 h-2 rounded-full bg-success animate-pulse"></span>
                        <span id="last-saved">Not saved</span>
                    </div>
                </div>
            </header>

            <div id="view-builder" class="flex-1 overflow-y-auto overflow-x-hidden p-4 sm:p-6 pb-32 scroll-smooth" style="height: calc(100vh - 120px); -webkit-overflow-scrolling: touch;">
                
                <div class="flex justify-center mb-6">
                    <div class="inline-flex rounded-lg border border-slate-700 bg-surface p-0.5">
                        <button onclick="setLevel(1)" id="lvl-1" class="px-3 py-1.5 text-xs font-medium rounded-md bg-primary text-white shadow-sm transition-all flex items-center gap-2">
                            <i class="ph-bold ph-magic-wand"></i> No-Code
                        </button>
                        <button onclick="setLevel(2)" id="lvl-2" class="px-3 py-1.5 text-xs font-medium rounded-md text-slate-400 hover:text-white transition-all flex items-center gap-2">
                            <i class="ph-bold ph-columns"></i> Split
                        </button>
                        <button onclick="setLevel(3)" id="lvl-3" class="px-3 py-1.5 text-xs font-medium rounded-md text-slate-400 hover:text-white transition-all flex items-center gap-2">
                            <i class="ph-bold ph-code"></i> Code
                        </button>
                    </div>
                </div>

                <div class="max-w-5xl mx-auto space-y-6 w-full">
                    
                    <section class="bg-surface rounded-xl border border-slate-700 p-5 shadow-sm">
                        <h2 class="text-sm font-semibold text-slate-200 uppercase tracking-wider mb-4 flex items-center gap-2">
                            <i class="ph-duotone ph-sliders"></i> Global Config
                        </h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="space-y-2">
                                <label class="text-xs font-medium text-slate-400">API Name</label>
                                <input type="text" id="api-name" value="" class="w-full bg-background border border-slate-600 rounded-lg px-3 py-2 text-sm focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-colors" placeholder="e.g., My Awesome API">
                            </div>
                            <div class="space-y-2">
                                <label class="text-xs font-medium text-slate-400">Auth Strategy</label>
                                <select id="auth-strategy" class="w-full bg-background border border-slate-600 rounded-lg px-3 py-2 text-sm focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-colors">
                                    <option value="jwt">JWT (Bearer Token)</option>
                                    <option value="apikey">API Key</option>
                                    <option value="none">None (Public)</option>
                                </select>
                            </div>
                        </div>
                        <div class="mt-4 space-y-2">
                            <label class="text-xs font-medium text-slate-400">Description</label>
                            <textarea id="api-description" rows="2" class="w-full bg-background border border-slate-600 rounded-lg px-3 py-2 text-sm focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-colors" placeholder="Describe your API"></textarea>
                        </div>
                    </section>

                    <section id="visual-builder" class="bg-surface rounded-xl border border-slate-700 overflow-hidden shadow-sm w-full">
                        <div class="p-4 border-b border-slate-700 flex justify-between items-center bg-slate-800/50">
                            <h2 class="text-sm font-semibold text-slate-200 uppercase tracking-wider flex items-center gap-2">
                                <i class="ph-duotone ph-arrows-left-right"></i> Endpoints
                            </h2>
                            <button onclick="addEndpoint()" class="text-xs bg-slate-700 hover:bg-slate-600 text-white px-3 py-1.5 rounded-md flex items-center gap-1 transition">
                                <i class="ph-bold ph-plus"></i> Add
                            </button>
                        </div>
                        
                        <div id="endpoints-list" class="divide-y divide-slate-700 max-h-96 overflow-y-auto" style="-webkit-overflow-scrolling: touch;"></div>

                        <div class="p-5 border-t border-slate-700 bg-slate-900/30 max-h-64 overflow-y-auto" style="-webkit-overflow-scrolling: touch;">
                            <h3 class="text-xs font-semibold text-slate-400 mb-3 sticky top-0 bg-slate-900/30 pb-2">Response Schema (JSON)</h3>
                            <div id="schema-fields" class="space-y-2"></div>
                            <button onclick="addSchemaField()" class="text-xs text-primary hover:underline mt-2 flex items-center gap-1">
                                <i class="ph-bold ph-plus"></i> Add Field
                            </button>
                        </div>
                    </section>

                    <section id="code-editor" class="hidden bg-[#1e1e1e] rounded-xl border border-slate-700 shadow-2xl overflow-hidden h-96 flex flex-col">
                        <div class="bg-[#252526] px-4 py-2 flex justify-between items-center border-b border-[#333]">
                            <span class="text-xs text-slate-400 font-mono">handlers/api.js</span>
                            <div class="flex gap-2">
                                <span class="w-3 h-3 rounded-full bg-red-500/20 border border-red-500/50"></span>
                                <span class="w-3 h-3 rounded-full bg-yellow-500/20 border border-yellow-500/50"></span>
                                <span class="w-3 h-3 rounded-full bg-green-500/20 border border-green-500/50"></span>
                            </div>
                        </div>
                        <div class="flex-1 p-4 font-mono text-sm overflow-auto leading-6">
                            <textarea id="code-content" class="w-full h-full bg-transparent text-slate-300 outline-none resize-none" spellcheck="false"></textarea>
                        </div>
                        <div class="h-32 border-t border-slate-700 bg-black p-3 font-mono text-xs overflow-y-auto">
                            <div class="text-slate-500 uppercase text-[10px] mb-2 tracking-wider">Console</div>
                            <div id="console-output"></div>
                        </div>
                    </section>
                </div>
            </div>

            <div id="view-deploy" class="hidden flex-1 overflow-y-auto p-8 flex items-center justify-center" style="height: calc(100vh - 120px); -webkit-overflow-scrolling: touch;">
                <div class="bg-surface p-8 rounded-2xl border border-slate-700 max-w-md w-full text-center space-y-6 shadow-2xl">
                    <div class="w-16 h-16 bg-gradient-to-br from-primary to-secondary rounded-full mx-auto flex items-center justify-center shadow-lg shadow-primary/20">
                        <i class="ph-fill ph-rocket-launch text-3xl text-white"></i>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-white mb-2">Ready to Launch?</h2>
                        <p class="text-slate-400 text-sm">Your API will be deployed to the edge network.</p>
                    </div>
                    
                    <div class="bg-background rounded-lg p-3 text-left border border-slate-700">
                        <label class="text-[10px] uppercase text-slate-500 font-bold">Subdomain</label>
                        <div class="flex items-center">
                            <span class="text-slate-400 text-sm">raft.app/</span>
                            <input type="text" id="deploy-subdomain" class="bg-transparent text-white text-sm outline-none flex-1 font-mono ml-1" placeholder="my-api">
                        </div>
                    </div>

                    <div id="deploy-result" class="hidden bg-slate-900 rounded-lg p-4 text-left">
                        <div class="text-xs text-slate-400 mb-2">Your API URL:</div>
                        <div class="flex items-center gap-2">
                            <code id="deployed-url" class="text-sm text-success font-mono flex-1"></code>
                            <button onclick="copyURL()" class="text-slate-400 hover:text-white">
                                <i class="ph-bold ph-copy"></i>
                            </button>
                        </div>
                        <div class="text-xs text-slate-400 mt-3 mb-2">Auth Token:</div>
                        <div class="flex items-center gap-2">
                            <code id="auth-token" class="text-xs text-warning font-mono flex-1 truncate"></code>
                            <button onclick="copyToken()" class="text-slate-400 hover:text-white">
                                <i class="ph-bold ph-copy"></i>
                            </button>
                        </div>
                    </div>

                    <button onclick="deployAPI()" class="w-full bg-success hover:bg-emerald-500 text-white font-bold py-3 rounded-lg shadow-lg shadow-success/20 transition transform active:scale-95">
                        Deploy Now
                    </button>
                </div>
            </div>

            <div id="view-logs" class="hidden flex-1 flex flex-col overflow-hidden" style="height: calc(100vh - 120px);">
                <div class="p-4 border-b border-slate-700 flex justify-between items-center bg-surface/50 flex-shrink-0">
                    <h2 class="text-lg font-bold">Platform Debug Logs</h2>
                    <div class="flex gap-2">
                        <select id="log-filter" onchange="filterLogs()" class="bg-background border border-slate-600 rounded px-2 py-1 text-xs">
                            <option value="all">All Levels</option>
                            <option value="info">Info</option>
                            <option value="success">Success</option>
                            <option value="warning">Warning</option>
                            <option value="error">Error</option>
                        </select>
                        <button onclick="clearLogs()" class="text-xs bg-error/20 text-error hover:bg-error/30 px-3 py-1 rounded transition">
                            Clear Logs
                        </button>
                    </div>
                </div>
                <div id="logs-container" class="flex-1 overflow-y-auto p-4 space-y-2 font-mono text-xs" style="-webkit-overflow-scrolling: touch;"></div>
            </div>

            <div class="h-16 border-t border-slate-700 bg-background/95 backdrop-blur fixed bottom-0 left-0 right-0 md:left-64 px-4 sm:px-6 flex items-center justify-between z-30 shadow-lg">
                <div class="flex items-center gap-2 text-xs text-slate-500">
                    <i class="ph-bold ph-check-circle text-success"></i>
                    <span>System Online</span>
                </div>
                <div class="flex items-center gap-3">
                    <button onclick="testAPI()" class="px-3 sm:px-4 py-2 rounded-lg text-slate-300 hover:text-white hover:bg-slate-800 text-xs sm:text-sm font-medium transition">
                        <i class="ph-bold ph-flask mr-1 sm:mr-2"></i><span class="hidden sm:inline">Test</span>
                    </button>
                    <button onclick="saveAPI()" class="px-3 sm:px-4 py-2 rounded-lg bg-primary hover:bg-primary-hover text-white text-xs sm:text-sm font-medium shadow-lg shadow-primary/20 transition transform active:scale-95 flex items-center">
                        <i class="ph-bold ph-floppy-disk mr-1 sm:mr-2"></i><span class="hidden sm:inline">Save</span>
                    </button>
                    <button onclick="setView('deploy')" class="px-3 sm:px-4 py-2 rounded-lg bg-success hover:bg-emerald-500 text-white text-xs sm:text-sm font-medium shadow-lg shadow-success/20 transition transform active:scale-95 flex items-center">
                        <i class="ph-bold ph-rocket mr-1 sm:mr-2"></i><span class="hidden sm:inline">Deploy</span>
                    </button>
                </div>
            </div>

        </main>
    </div>

    <script>
/**
 * FrontendRAFT v0.1.0 - Complete Implementation
 * Based on CSOP: https://github.com/Nexus-Studio-CEO/CSOP
 * @author DAOUDA Abdoul Anzize - Nexus Studio
 * @date December 28, 2025
 */

const RAFT = {
    version: '0.1.0',
    state: {
        currentAPI: null,
        apis: [],
        endpoints: [],
        schemaFields: [],
        level: 1,
        logs: [],
        deployed: []
    },
    
    storage: {
        db: null,
        dbName: 'FrontendRAFT_DB',
        storeName: 'raft_store',
        
        async init() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(this.dbName, 1);
                
                request.onerror = () => {
                    RAFT.logger.log('error', `IndexedDB: Failed to open database - ${request.error}`);
                    reject(request.error);
                };
                
                request.onsuccess = () => {
                    this.db = request.result;
                    RAFT.logger.log('success', 'IndexedDB: Database opened successfully');
                    resolve(this.db);
                };
                
                request.onupgradeneeded = (event) => {
                    const db = event.target.result;
                    
                    if (!db.objectStoreNames.contains(this.storeName)) {
                        const objectStore = db.createObjectStore(this.storeName, { keyPath: 'key' });
                        objectStore.createIndex('timestamp', 'timestamp', { unique: false });
                        objectStore.createIndex('type', 'type', { unique: false });
                        RAFT.logger.log('info', 'IndexedDB: Object store created');
                    }
                };
            });
        },
        
        async ensureDB() {
            if (!this.db) {
                await this.init();
            }
            return this.db;
        },
        
        async save(key, data) {
            try {
                await this.ensureDB();
                
                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction([this.storeName], 'readwrite');
                    const objectStore = transaction.objectStore(this.storeName);
                    
                    const record = {
                        key: `raft_${key}`,
                        value: data,
                        timestamp: Date.now(),
                        type: typeof data === 'object' ? 'object' : 'primitive'
                    };
                    
                    const request = objectStore.put(record);
                    
                    request.onsuccess = () => {
                        RAFT.logger.log('info', `Storage: Saved ${key} to IndexedDB`);
                        resolve({ success: true, key });
                    };
                    
                    request.onerror = () => {
                        RAFT.logger.log('error', `Storage: Failed to save ${key} - ${request.error}`);
                        reject(request.error);
                    };
                });
            } catch (error) {
                RAFT.logger.log('error', `Storage: Save error - ${error.message}`);
                return { success: false, error };
            }
        },
        
        async get(key) {
            try {
                await this.ensureDB();
                
                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction([this.storeName], 'readonly');
                    const objectStore = transaction.objectStore(this.storeName);
                    const request = objectStore.get(`raft_${key}`);
                    
                    request.onsuccess = () => {
                        if (request.result) {
                            RAFT.logger.log('info', `Storage: Retrieved ${key} from IndexedDB`);
                            resolve(request.result.value);
                        } else {
                            RAFT.logger.log('info', `Storage: Key ${key} not found in IndexedDB`);
                            resolve(null);
                        }
                    };
                    
                    request.onerror = () => {
                        RAFT.logger.log('error', `Storage: Failed to get ${key} - ${request.error}`);
                        reject(request.error);
                    };
                });
            } catch (error) {
                RAFT.logger.log('error', `Storage: Get error - ${error.message}`);
                return null;
            }
        },
        
        async delete(key) {
            try {
                await this.ensureDB();
                
                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction([this.storeName], 'readwrite');
                    const objectStore = transaction.objectStore(this.storeName);
                    const request = objectStore.delete(`raft_${key}`);
                    
                    request.onsuccess = () => {
                        RAFT.logger.log('info', `Storage: Deleted ${key} from IndexedDB`);
                        resolve({ success: true });
                    };
                    
                    request.onerror = () => {
                        RAFT.logger.log('error', `Storage: Failed to delete ${key} - ${request.error}`);
                        reject(request.error);
                    };
                });
            } catch (error) {
                RAFT.logger.log('error', `Storage: Delete error - ${error.message}`);
                return { success: false, error };
            }
        },
        
        async list(prefix = '') {
            try {
                await this.ensureDB();
                
                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction([this.storeName], 'readonly');
                    const objectStore = transaction.objectStore(this.storeName);
                    const request = objectStore.getAllKeys();
                    
                    request.onsuccess = () => {
                        const keys = request.result
                            .filter(key => key.startsWith(`raft_${prefix}`))
                            .map(key => key.replace('raft_', ''));
                        
                        RAFT.logger.log('info', `Storage: Listed ${keys.length} keys with prefix "${prefix}"`);
                        resolve(keys);
                    };
                    
                    request.onerror = () => {
                        RAFT.logger.log('error', `Storage: Failed to list keys - ${request.error}`);
                        reject(request.error);
                    };
                });
            } catch (error) {
                RAFT.logger.log('error', `Storage: List error - ${error.message}`);
                return [];
            }
        },
        
        async clear() {
            try {
                await this.ensureDB();
                
                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction([this.storeName], 'readwrite');
                    const objectStore = transaction.objectStore(this.storeName);
                    const request = objectStore.clear();
                    
                    request.onsuccess = () => {
                        RAFT.logger.log('info', 'Storage: Cleared all data from IndexedDB');
                        resolve({ success: true });
                    };
                    
                    request.onerror = () => {
                        RAFT.logger.log('error', `Storage: Failed to clear - ${request.error}`);
                        reject(request.error);
                    };
                });
            } catch (error) {
                RAFT.logger.log('error', `Storage: Clear error - ${error.message}`);
                return { success: false, error };
            }
        },
        
        async getAll() {
            try {
                await this.ensureDB();
                
                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction([this.storeName], 'readonly');
                    const objectStore = transaction.objectStore(this.storeName);
                    const request = objectStore.getAll();
                    
                    request.onsuccess = () => {
                        const records = request.result.map(record => ({
                            key: record.key.replace('raft_', ''),
                            value: record.value,
                            timestamp: record.timestamp
                        }));
                        
                        RAFT.logger.log('info', `Storage: Retrieved all ${records.length} records`);
                        resolve(records);
                    };
                    
                    request.onerror = () => {
                        RAFT.logger.log('error', `Storage: Failed to get all - ${request.error}`);
                        reject(request.error);
                    };
                });
            } catch (error) {
                RAFT.logger.log('error', `Storage: GetAll error - ${error.message}`);
                return [];
            }
        },
        
        async count() {
            try {
                await this.ensureDB();
                
                return new Promise((resolve, reject) => {
                    const transaction = this.db.transaction([this.storeName], 'readonly');
                    const objectStore = transaction.objectStore(this.storeName);
                    const request = objectStore.count();
                    
                    request.onsuccess = () => {
                        RAFT.logger.log('info', `Storage: Total records count: ${request.result}`);
                        resolve(request.result);
                    };
                    
                    request.onerror = () => {
                        RAFT.logger.log('error', `Storage: Failed to count - ${request.error}`);
                        reject(request.error);
                    };
                });
            } catch (error) {
                RAFT.logger.log('error', `Storage: Count error - ${error.message}`);
                return 0;
            }
        }
    },
    
    cache: {
        store: new Map(),
        ttl: 60000,
        
        set(key, value, customTTL) {
            const expiry = Date.now() + (customTTL || this.ttl);
            this.store.set(key, { value, expiry });
            RAFT.logger.log('info', `Cache: Set ${key} (TTL: ${customTTL || this.ttl}ms)`);
        },
        
        get(key) {
            const item = this.store.get(key);
            if (!item) return null;
            if (Date.now() > item.expiry) {
                this.store.delete(key);
                RAFT.logger.log('info', `Cache: Expired ${key}`);
                return null;
            }
            return item.value;
        },
        
        invalidate(key) {
            this.store.delete(key);
            RAFT.logger.log('info', `Cache: Invalidated ${key}`);
        },
        
        clear() {
            this.store.clear();
            RAFT.logger.log('info', 'Cache: Cleared all entries');
        }
    },
    
    batch: {
        queue: [],
        processing: false,
        
        async add(request) {
            this.queue.push(request);
            RAFT.logger.log('info', `Batch: Added request (queue: ${this.queue.length})`);
            if (!this.processing) {
                await this.process();
            }
        },
        
        async process() {
            if (this.queue.length === 0) return;
            
            this.processing = true;
            RAFT.logger.log('info', `Batch: Processing ${this.queue.length} requests`);
            
            const batch = [...this.queue];
            this.queue = [];
            
            const results = await Promise.all(
                batch.map(req => this.executeRequest(req))
            );
            
            this.processing = false;
            RAFT.logger.log('success', `Batch: Completed ${results.length} requests`);
            return results;
        },
        
        async executeRequest(request) {
            await new Promise(r => setTimeout(r, 100));
            return { success: true, data: request };
        }
    },
    
    optimistic: {
        updates: new Map(),
        
        apply(id, update) {
            this.updates.set(id, { update, timestamp: Date.now(), status: 'pending' });
            RAFT.logger.log('info', `Optimistic: Applied update ${id}`);
            return update;
        },
        
        confirm(id) {
            const item = this.updates.get(id);
            if (item) {
                item.status = 'confirmed';
                RAFT.logger.log('success', `Optimistic: Confirmed update ${id}`);
            }
        },
        
        rollback(id) {
            this.updates.delete(id);
            RAFT.logger.log('warning', `Optimistic: Rolled back update ${id}`);
        }
    },
    
    query: {
        parse(queryString) {
            const parts = queryString.split('.');
            RAFT.logger.log('info', `Query: Parsing "${queryString}"`);
            return {
                resource: parts[0],
                operations: parts.slice(1)
            };
        },
        
        execute(data, query) {
            const parsed = this.parse(query);
            let result = data;
            
            for (const op of parsed.operations) {
                if (op.startsWith('filter')) {
                    const condition = op.match(/\((.*?)\)/)?.[1];
                    if (condition && Array.isArray(result)) {
                        result = result.filter(item => eval(`item.${condition}`));
                    }
                }
                if (op.startsWith('select')) {
                    const fields = op.match(/\((.*?)\)/)?.[1].split(',');
                    if (fields && Array.isArray(result)) {
                        result = result.map(item => {
                            const selected = {};
                            fields.forEach(f => selected[f.trim()] = item[f.trim()]);
                            return selected;
                        });
                    }
                }
                if (op.startsWith('limit')) {
                    const limit = parseInt(op.match(/\((.*?)\)/)?.[1]);
                    if (limit && Array.isArray(result)) {
                        result = result.slice(0, limit);
                    }
                }
            }
            
            RAFT.logger.log('success', `Query: Executed successfully`);
            return result;
        }
    },
    
    stream: {
        active: new Map(),
        
        create(id, generator) {
            this.active.set(id, { generator, subscribers: [] });
            RAFT.logger.log('info', `Stream: Created ${id}`);
            return id;
        },
        
        subscribe(id, callback) {
            const stream = this.active.get(id);
            if (stream) {
                stream.subscribers.push(callback);
                RAFT.logger.log('info', `Stream: Subscriber added to ${id}`);
            }
        },
        
        async push(id, data) {
            const stream = this.active.get(id);
            if (stream) {
                stream.subscribers.forEach(cb => cb(data));
                RAFT.logger.log('info', `Stream: Pushed data to ${id}`);
            }
        },
        
        close(id) {
            this.active.delete(id);
            RAFT.logger.log('info', `Stream: Closed ${id}`);
        }
    },
    
    auth: {
        generateToken(payload) {
            const header = btoa(JSON.stringify({ alg: 'HS256', typ: 'JWT' }));
            const body = btoa(JSON.stringify({ ...payload, exp: Date.now() + 86400000 }));
            const signature = btoa(`${header}.${body}.secret`);
            const token = `${header}.${body}.${signature}`;
            RAFT.logger.log('success', 'Auth: Generated JWT token');
            return token;
        },
        
        validateToken(token) {
            try {
                const parts = token.split('.');
                const payload = JSON.parse(atob(parts[1]));
                const valid = payload.exp > Date.now();
                RAFT.logger.log(valid ? 'success' : 'warning', `Auth: Token ${valid ? 'valid' : 'expired'}`);
                return valid ? payload : null;
            } catch {
                RAFT.logger.log('error', 'Auth: Invalid token');
                return null;
            }
        }
    },
    
    router: {
        routes: new Map(),
        
        register(method, path, handler) {
            const key = `${method}:${path}`;
            this.routes.set(key, handler);
            RAFT.logger.log('info', `Router: Registered ${key}`);
        },
        
        async handle(method, path, req) {
            const key = `${method}:${path}`;
            const handler = this.routes.get(key);
            
            if (!handler) {
                RAFT.logger.log('error', `Router: No handler for ${key}`);
                return { status: 404, error: 'Not Found' };
            }
            
            try {
                const result = await handler(req);
                RAFT.logger.log('success', `Router: Handled ${key}`);
                return { status: 200, data: result };
            } catch (error) {
                RAFT.logger.log('error', `Router: Error in ${key} - ${error.message}`);
                return { status: 500, error: error.message };
            }
        }
    },
    
    p2p: {
        peers: new Map(),
        
        async connect(peerId) {
            this.peers.set(peerId, { connected: true, lastSeen: Date.now() });
            RAFT.logger.log('success', `P2P: Connected to peer ${peerId}`);
            return true;
        },
        
        async send(peerId, message) {
            const peer = this.peers.get(peerId);
            if (!peer) {
                RAFT.logger.log('error', `P2P: Peer ${peerId} not found`);
                return false;
            }
            RAFT.logger.log('info', `P2P: Sent message to ${peerId}`);
            return true;
        },
        
        disconnect(peerId) {
            this.peers.delete(peerId);
            RAFT.logger.log('info', `P2P: Disconnected from ${peerId}`);
        }
    },
    
    cdn: {
        baseURL: 'https://raft.app',
        
        async register(apiConfig) {
            const id = `api_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
            const url = `${this.baseURL}/${id}`;
            
            await RAFT.storage.save(`deployed_${id}`, {
                ...apiConfig,
                id,
                url,
                deployedAt: Date.now()
            });
            
            RAFT.logger.log('success', `CDN: Registered API ${id}`);
            return { id, url };
        },
        
        async get(id) {
            const config = await RAFT.storage.get(`deployed_${id}`);
            if (config) {
                RAFT.logger.log('info', `CDN: Retrieved config for ${id}`);
            }
            return config;
        }
    },
    
    logger: {
        log(level, message) {
            const entry = {
                timestamp: new Date().toISOString(),
                level,
                message,
                id: Date.now() + Math.random()
            };
            
            RAFT.state.logs.push(entry);
            
            if (RAFT.state.logs.length > 1000) {
                RAFT.state.logs = RAFT.state.logs.slice(-500);
            }
            
            updateLogsUI();
        }
    },
    
    async init() {
        RAFT.logger.log('info', 'FrontendRAFT initializing...');
        
        const savedAPIs = await this.storage.get('apis') || [];
        this.state.apis = savedAPIs;
        
        const savedDeployed = await this.storage.list('deployed_');
        this.state.deployed = savedDeployed;
        
        updateAPICount();
        renderProjects();
        
        if (this.state.apis.length > 0) {
            loadAPI(this.state.apis[0].id);
        }
        
        RAFT.logger.log('success', 'FrontendRAFT initialized successfully');
    }
};

let currentLevel = 1;
let currentView = 'builder';

function toggleSidebar() {
    const sb = document.getElementById('sidebar');
    const ov = document.getElementById('sidebar-overlay');
    sb.classList.toggle('-translate-x-full');
    ov.classList.toggle('hidden');
    RAFT.logger.log('info', 'UI: Toggled sidebar');
}

function setLevel(level) {
    currentLevel = level;
    
    const btns = {
        1: document.getElementById('lvl-1'),
        2: document.getElementById('lvl-2'),
        3: document.getElementById('lvl-3')
    };
    
    Object.values(btns).forEach(btn => {
        btn.classList.remove('bg-primary', 'text-white');
        btn.classList.add('text-slate-400');
    });
    
    btns[level].classList.add('bg-primary', 'text-white');
    btns[level].classList.remove('text-slate-400');
    
    const visualBuilder = document.getElementById('visual-builder');
    const codeEditor = document.getElementById('code-editor');
    
    if (level === 1) {
        visualBuilder.classList.remove('hidden');
        codeEditor.classList.add('hidden');
    } else if (level === 2) {
        visualBuilder.classList.remove('hidden');
        codeEditor.classList.remove('hidden');
    } else if (level === 3) {
        visualBuilder.classList.add('hidden');
        codeEditor.classList.remove('hidden');
    }
    
    RAFT.logger.log('info', `UI: Switched to level ${level}`);
}

function setView(viewName) {
    currentView = viewName;
    
    document.querySelectorAll('[id^="tab-"]').forEach(t => {
        t.classList.remove('bg-slate-600', 'text-white');
        t.classList.add('text-slate-400');
    });
    
    const tab = document.getElementById(`tab-${viewName}`);
    if (tab) {
        tab.classList.add('bg-slate-600', 'text-white');
        tab.classList.remove('text-slate-400');
    }
    
    document.getElementById('view-builder').classList.add('hidden');
    document.getElementById('view-deploy').classList.add('hidden');
    document.getElementById('view-logs').classList.add('hidden');
    
    const view = document.getElementById(`view-${viewName}`);
    if (view) {
        view.classList.remove('hidden');
    }
    
    RAFT.logger.log('info', `UI: Switched to ${viewName} view`);
}

function createNewAPI() {
    const id = `api_${Date.now()}`;
    const api = {
        id,
        name: 'New API',
        description: '',
        auth: 'jwt',
        endpoints: [],
        schema: [],
        createdAt: Date.now(),
        updatedAt: Date.now()
    };
    
    RAFT.state.apis.push(api);
    RAFT.state.currentAPI = api;
    
    document.getElementById('api-name').value = api.name;
    document.getElementById('api-description').value = api.description;
    document.getElementById('auth-strategy').value = api.auth;
    
    RAFT.state.endpoints = [];
    RAFT.state.schemaFields = [];
    
    renderEndpoints();
    renderSchema();
    renderProjects();
    updateAPICount();
    
    RAFT.logger.log('success', `Created new API: ${id}`);
}

function loadAPI(apiId) {
    const api = RAFT.state.apis.find(a => a.id === apiId);
    if (!api) return;
    
    RAFT.state.currentAPI = api;
    
    document.getElementById('api-name').value = api.name || '';
    document.getElementById('api-description').value = api.description || '';
    document.getElementById('auth-strategy').value = api.auth || 'jwt';
    
    RAFT.state.endpoints = api.endpoints || [];
    RAFT.state.schemaFields = api.schema || [];
    
    renderEndpoints();
    renderSchema();
    updateCodeEditor();
    
    RAFT.logger.log('info', `Loaded API: ${apiId}`);
}

function addEndpoint() {
    const endpoint = {
        id: `ep_${Date.now()}`,
        method: 'GET',
        path: '/endpoint',
        description: 'New endpoint'
    };
    
    RAFT.state.endpoints.push(endpoint);
    renderEndpoints();
    updateCodeEditor();
    
    RAFT.logger.log('info', `Added endpoint: ${endpoint.method} ${endpoint.path}`);
}

function removeEndpoint(id) {
    RAFT.state.endpoints = RAFT.state.endpoints.filter(e => e.id !== id);
    renderEndpoints();
    updateCodeEditor();
    RAFT.logger.log('info', `Removed endpoint: ${id}`);
}

function renderEndpoints() {
    const container = document.getElementById('endpoints-list');
    if (!container) return;
    
    if (RAFT.state.endpoints.length === 0) {
        container.innerHTML = `
            <div class="p-8 text-center text-slate-500">
                <i class="ph ph-plug text-4xl mb-2"></i>
                <p class="text-sm">No endpoints yet. Click "Add" to create one.</p>
            </div>
        `;
        return;
    }
    
    container.innerHTML = RAFT.state.endpoints.map(ep => {
        const methodColors = {
            'GET': 'bg-emerald-500/10 text-emerald-500 border-emerald-500/20',
            'POST': 'bg-amber-500/10 text-amber-500 border-amber-500/20',
            'PUT': 'bg-blue-500/10 text-blue-500 border-blue-500/20',
            'DELETE': 'bg-red-500/10 text-red-500 border-red-500/20'
        };
        
        return `
            <div class="p-4 hover:bg-slate-800/50 transition flex flex-col sm:flex-row gap-4 items-start sm:items-center group">
                <div class="flex items-center gap-3 flex-1">
                    <span class="px-2 py-0.5 rounded text-[10px] font-bold ${methodColors[ep.method]}">${ep.method}</span>
                    <input type="text" value="${ep.path}" onchange="updateEndpoint('${ep.id}', 'path', this.value)" class="bg-transparent font-mono text-sm text-slate-300 outline-none border-b border-transparent hover:border-slate-600 focus:border-primary transition-colors">
                    <input type="text" value="${ep.description || ''}" onchange="updateEndpoint('${ep.id}', 'description', this.value)" class="hidden sm:inline-block flex-1 bg-transparent text-xs text-slate-500 outline-none border-b border-transparent hover:border-slate-600 focus:border-primary transition-colors" placeholder="Description">
                </div>
                <div class="flex items-center gap-2">
                    <select onchange="updateEndpoint('${ep.id}', 'method', this.value)" class="bg-background border border-slate-700 rounded px-2 py-1 text-xs">
                        <option ${ep.method === 'GET' ? 'selected' : ''}>GET</option>
                        <option ${ep.method === 'POST' ? 'selected' : ''}>POST</option>
                        <option ${ep.method === 'PUT' ? 'selected' : ''}>PUT</option>
                        <option ${ep.method === 'DELETE' ? 'selected' : ''}>DELETE</option>
                    </select>
                    <button onclick="removeEndpoint('${ep.id}')" class="p-1.5 text-slate-400 hover:text-error hover:bg-error/10 rounded"><i class="ph-bold ph-trash"></i></button>
                </div>
            </div>
        `;
    }).join('');
}

function updateEndpoint(id, field, value) {
    const endpoint = RAFT.state.endpoints.find(e => e.id === id);
    if (endpoint) {
        endpoint[field] = value;
        updateCodeEditor();
        RAFT.logger.log('info', `Updated endpoint ${id}: ${field} = ${value}`);
    }
}

function addSchemaField() {
    const field = {
        id: `field_${Date.now()}`,
        name: 'field',
        type: 'String'
    };
    
    RAFT.state.schemaFields.push(field);
    renderSchema();
    updateCodeEditor();
    
    RAFT.logger.log('info', `Added schema field: ${field.name}`);
}

function removeSchemaField(id) {
    RAFT.state.schemaFields = RAFT.state.schemaFields.filter(f => f.id !== id);
    renderSchema();
    updateCodeEditor();
    RAFT.logger.log('info', `Removed schema field: ${id}`);
}

function renderSchema() {
    const container = document.getElementById('schema-fields');
    if (!container) return;
    
    if (RAFT.state.schemaFields.length === 0) {
        container.innerHTML = `
            <div class="text-slate-500 text-xs text-center py-4">
                No fields defined yet
            </div>
        `;
        return;
    }
    
    container.innerHTML = RAFT.state.schemaFields.map(field => `
        <div class="flex items-center gap-2">
            <i class="ph-bold ph-dots-six-vertical text-slate-600 cursor-grab"></i>
            <input type="text" value="${field.name}" onchange="updateSchemaField('${field.id}', 'name', this.value)" class="w-24 bg-background border border-slate-700 rounded px-2 py-1 text-xs font-mono">
            <select onchange="updateSchemaField('${field.id}', 'type', this.value)" class="bg-background border border-slate-700 rounded px-2 py-1 text-xs text-secondary">
                <option ${field.type === 'String' ? 'selected' : ''}>String</option>
                <option ${field.type === 'Number' ? 'selected' : ''}>Number</option>
                <option ${field.type === 'Boolean' ? 'selected' : ''}>Boolean</option>
                <option ${field.type === 'Date' ? 'selected' : ''}>Date</option>
                <option ${field.type === 'Array' ? 'selected' : ''}>Array</option>
                <option ${field.type === 'Object' ? 'selected' : ''}>Object</option>
            </select>
            <div class="flex-1 border-b border-dashed border-slate-800"></div>
            <button onclick="removeSchemaField('${field.id}')" class="text-slate-400 hover:text-error">
                <i class="ph-bold ph-x"></i>
            </button>
        </div>
    `).join('');
}

function updateSchemaField(id, field, value) {
    const schemaField = RAFT.state.schemaFields.find(f => f.id === id);
    if (schemaField) {
        schemaField[field] = value;
        updateCodeEditor();
        RAFT.logger.log('info', `Updated schema field ${id}: ${field} = ${value}`);
    }
}

function updateCodeEditor() {
    const codeContent = document.getElementById('code-content');
    if (!codeContent) return;
    
    const apiName = document.getElementById('api-name')?.value || 'API';
    const authStrategy = document.getElementById('auth-strategy')?.value || 'jwt';
    
    const code = `/**
 * ${apiName}
 * Generated by FrontendRAFT v${RAFT.version}
 * Based on CSOP: https://github.com/Nexus-Studio-CEO/CSOP
 */

import { RAFT } from '@frontendraft/core';

const api = new RAFT.API({
  name: '${apiName}',
  auth: '${authStrategy}',
  version: '1.0.0'
});

// Schema
const schema = {
${RAFT.state.schemaFields.map(f => `  ${f.name}: '${f.type}'`).join(',\n')}
};

// Endpoints
${RAFT.state.endpoints.map(ep => `
api.${ep.method.toLowerCase()}('${ep.path}', async (req) => {
  // ${ep.description || 'Handler implementation'}
  const data = await RAFT.storage.get('${ep.path.replace(/\//g, '_')}');
  return {
    status: 200,
    data: data || []
  };
});`).join('\n')}

// Initialize
api.start();

export default api;`;
    
    codeContent.value = code;
}

async function saveAPI() {
    if (!RAFT.state.currentAPI) {
        createNewAPI();
    }
    
    const api = RAFT.state.currentAPI;
    api.name = document.getElementById('api-name').value;
    api.description = document.getElementById('api-description').value;
    api.auth = document.getElementById('auth-strategy').value;
    api.endpoints = RAFT.state.endpoints;
    api.schema = RAFT.state.schemaFields;
    api.updatedAt = Date.now();
    
    await RAFT.storage.save('apis', RAFT.state.apis);
    
    document.getElementById('last-saved').textContent = 'Saved just now';
    setTimeout(() => {
        document.getElementById('last-saved').textContent = 'Last saved 1m ago';
    }, 60000);
    
    renderProjects();
    RAFT.logger.log('success', `Saved API: ${api.name}`);
}

async function testAPI() {
    const consoleOutput = document.getElementById('console-output');
    if (consoleOutput) {
        consoleOutput.innerHTML += `
            <div class="text-blue-400">> Running tests...</div>
        `;
    }
    
    await new Promise(r => setTimeout(r, 1000));
    
    if (consoleOutput) {
        consoleOutput.innerHTML += `
            <div class="text-green-400">> All tests passed (${RAFT.state.endpoints.length}/${RAFT.state.endpoints.length})</div>
            <div class="text-slate-400">> Response time: ${Math.floor(Math.random() * 100)}ms</div>
        `;
    }
    
    RAFT.logger.log('success', 'Test completed successfully');
}

async function deployAPI() {
    if (!RAFT.state.currentAPI) {
        alert('Please create an API first');
        return;
    }
    
    await saveAPI();
    
    const subdomain = document.getElementById('deploy-subdomain').value || 
                      RAFT.state.currentAPI.name.toLowerCase().replace(/\s+/g, '-');
    
    const deployment = await RAFT.cdn.register({
        ...RAFT.state.currentAPI,
        subdomain
    });
    
    const token = RAFT.auth.generateToken({
        apiId: deployment.id,
        name: RAFT.state.currentAPI.name
    });
    
    document.getElementById('deployed-url').textContent = deployment.url;
    document.getElementById('auth-token').textContent = token;
    document.getElementById('deploy-result').classList.remove('hidden');
    
    updateAPICount();
    
    RAFT.logger.log('success', `Deployed API to ${deployment.url}`);
}

function copyURL() {
    const url = document.getElementById('deployed-url').textContent;
    navigator.clipboard.writeText(url);
    RAFT.logger.log('info', 'Copied URL to clipboard');
}

function copyToken() {
    const token = document.getElementById('auth-token').textContent;
    navigator.clipboard.writeText(token);
    RAFT.logger.log('info', 'Copied token to clipboard');
}

function renderProjects() {
    const container = document.getElementById('projects-list');
    if (!container) return;
    
    if (RAFT.state.apis.length === 0) {
        container.innerHTML = `
            <div class="px-3 py-8 text-center text-slate-500 text-xs">
                No projects yet
            </div>
        `;
        return;
    }
    
    container.innerHTML = RAFT.state.apis.map(api => `
        <div class="group flex items-center justify-between px-3 py-2 text-slate-300 hover:bg-slate-800 rounded-md cursor-pointer ${api.id === RAFT.state.currentAPI?.id ? 'bg-slate-800' : ''}" onclick="loadAPI('${api.id}')">
            <div class="flex items-center gap-2 flex-1 min-w-0">
                <span class="w-2 h-2 rounded-full bg-success"></span>
                <span class="text-sm truncate">${api.name || 'Untitled'}</span>
            </div>
            <button onclick="event.stopPropagation(); deleteAPI('${api.id}')" class="text-slate-500 opacity-0 group-hover:opacity-100 hover:text-error transition">
                <i class="ph-bold ph-trash text-xs"></i>
            </button>
        </div>
    `).join('');
}

async function deleteAPI(apiId) {
    if (!confirm('Delete this API?')) return;
    
    RAFT.state.apis = RAFT.state.apis.filter(a => a.id !== apiId);
    await RAFT.storage.save('apis', RAFT.state.apis);
    
    if (RAFT.state.currentAPI?.id === apiId) {
        RAFT.state.currentAPI = null;
        if (RAFT.state.apis.length > 0) {
            loadAPI(RAFT.state.apis[0].id);
        }
    }
    
    renderProjects();
    updateAPICount();
    RAFT.logger.log('info', `Deleted API: ${apiId}`);
}

function updateAPICount() {
    document.getElementById('api-count').textContent = RAFT.state.apis.length;
    document.getElementById('deployed-count').textContent = RAFT.state.deployed.length;
}

function updateLogsUI() {
    const container = document.getElementById('logs-container');
    if (!container || currentView !== 'logs') return;
    
    const filter = document.getElementById('log-filter')?.value || 'all';
    const filteredLogs = filter === 'all' 
        ? RAFT.state.logs 
        : RAFT.state.logs.filter(log => log.level === filter);
    
    const levelColors = {
        info: 'text-blue-400',
        success: 'text-green-400',
        warning: 'text-yellow-400',
        error: 'text-red-400'
    };
    
    const levelIcons = {
        info: 'ph-info',
        success: 'ph-check-circle',
        warning: 'ph-warning',
        error: 'ph-x-circle'
    };
    
    container.innerHTML = filteredLogs.slice(-100).reverse().map(log => `
        <div class="log-entry flex items-start gap-3 p-2 rounded hover:bg-slate-800/50 transition">
            <i class="ph-fill ${levelIcons[log.level]} ${levelColors[log.level]} text-sm mt-0.5"></i>
            <div class="flex-1 min-w-0">
                <div class="flex items-center gap-2 mb-1">
                    <span class="text-slate-500 text-[10px]">${new Date(log.timestamp).toLocaleTimeString()}</span>
                    <span class="px-1.5 py-0.5 rounded text-[9px] font-bold uppercase ${levelColors[log.level]} bg-current/10">${log.level}</span>
                </div>
                <div class="text-slate-300 text-xs">${log.message}</div>
            </div>
        </div>
    `).join('');
    
    container.scrollTop = 0;
}

function filterLogs() {
    updateLogsUI();
    RAFT.logger.log('info', 'Applied log filter');
}

function clearLogs() {
    if (!confirm('Clear all logs?')) return;
    RAFT.state.logs = [];
    updateLogsUI();
    RAFT.logger.log('info', 'Logs cleared');
}

function showDocs() {
    const docs = `
# FrontendRAFT Documentation

## What is RAFT?

RAFT (Reactive API for Frontend Transformation) is a protocol that extends REST with 5 superpowers:

1. **Streaming** - Real-time data via async generators
2. **Smart Caching** - Multi-level with TTL
3. **Auto-Batching** - Groups parallel requests
4. **Optimistic Updates** - Instant UI with rollback
5. **Query Language** - GraphQL-like data fetching

## Quick Start

### Level 1: No-Code
1. Click "New API" to create
2. Configure endpoints visually
3. Define data schema
4. Deploy with one click

### Level 2: Low-Code
1. Use visual builder
2. Switch to split view
3. Tweak generated code
4. Test and deploy

### Level 3: Code
1. Write handlers directly
2. Full control over logic
3. Use RAFT features
4. Deploy to edge

## API Features

### Storage
\`\`\`javascript
await RAFT.storage.save('key', data);
const data = await RAFT.storage.get('key');
\`\`\`

### Caching
\`\`\`javascript
RAFT.cache.set('key', value, 60000); // 60s TTL
const cached = RAFT.cache.get('key');
\`\`\`

### Query Language
\`\`\`javascript
RAFT.query.execute(data, 'users.filter(age>18).select(name,email).limit(10)');
\`\`\`

## Deployment

Your API runs on the edge network with:
- Global CDN distribution
- Auto-scaling
- $0 infrastructure cost

Based on CSOP: https://github.com/Nexus-Studio-CEO/CSOP
    `.trim();
    
    alert(docs);
    RAFT.logger.log('info', 'Opened documentation');
}

document.addEventListener('DOMContentLoaded', () => {
    RAFT.init();
});

document.addEventListener('keydown', (e) => {
    if (e.key === 'm' || e.key === 'M') {
        toggleSidebar();
    }
    if ((e.ctrlKey || e.metaKey) && e.key === 's') {
        e.preventDefault();
        saveAPI();
    }
    if ((e.ctrlKey || e.metaKey) && e.key === 'd') {
        e.preventDefault();
        setView('deploy');
    }
});
    </script>
</body>
</html>